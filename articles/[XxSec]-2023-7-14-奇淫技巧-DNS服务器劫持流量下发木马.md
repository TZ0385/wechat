#  奇淫技巧-DNS服务器劫持流量下发木马

[ XxSec ](javascript:void\(0\);)

**XxSec** ![]()

微信号 gh_51582c8261c4

功能介绍 渗透，知识，编程

____

___发表于_

收录于合集

有时候我们在对没域的目标，或者对移动用户进行渗透的时候会很难下手，除了使用u盘感染，或者进行发送钓鱼邮件，好像没其他好的办法了，后面想着要是能把目标机构或者A国的某些知名的dns服务器控制了，使用dns下发木马的方式会不会事半功倍？

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230714181045.png)

  

  

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230714181047.png)

  

  

  

大致流程

## 一、获取到DNS服务器权限或者自己部署一台DNS服务器  

    这里的想法是这样的，要是获取不到目标dns服务器的话，需要自己搭一台，这样的话就需要配合线下行动了，比如配合badusb更改目标dns服务器，主要为什么不直接使用badusb下马呢，因为线下行动环境不可预见的，且情况很复杂，比如目标的笔记本可能不一定联网，那么这个时候你下发木马是没用的。当然这只是其中一种的情况，或者你把usb撒目标机构门口了，目标的网络访问权限做的很严格，只能访问白名单的url，那这样插usb也是没法进行通信的，这种情况就是改dns会好点。  

二、部署HTTP代理服务器

    这里应该不用解释了，软件更新走的通道

三、部署HTTP代理服务器

    很多软件更新时都走https所以还需搭建https代理服务器

 四、运行三个服务

    然后使用tcpdump或者其他的流量监控设备，分析流量，目标什么软件打开了，然后对其进行下发木马的操纵，替换更新软件，这样不太容易被发现 

## 总结  

    1.针对自动更新或后台静默更新的这类应用程序进行流量替换，这样成功率高被发现可能性也小

    2.当更新包请求是https时需要注意证书问题,可以尝试利用cname绕过，比如在dns服务器上把www.google.com重定向到www.gmail.com，gmail这样的合法证书这样就不会报错.

    3.在路由器上修改DNS也可以作为一种持久性控制的手段，某天权限不慎丢失了，继续植入就行了。

  

这只是初步的想法，后期要找一些资料看看，研究的差不多了，在写一篇实战的，也感谢群里老哥的解答

           

预览时标签不可点

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

