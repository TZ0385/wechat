#  CVE-2023-27178：GDidees CMS任意文件上传漏洞

原创 CSX安全实验室  [ 安帝Andisec ](javascript:void\(0\);)

**安帝Andisec** ![]()

微信号 Andisec

功能介绍
安帝科技是新兴的工业网络安全能力供应商，基于网络空间行为学及工业网络行为验证，专注于网络化、数字化、智能化背景下的工业网络安全技术、产品、服务的创新实践和探索。

____

___发表于_

收录于合集 #安全研究 55个

##
**![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184350.png)**

GDidees CMS是法国一款开源的网站管理工具，可用于创建站点、照片或视频库。GDidees CMS
3.9.1及以下版本存在任意文件上传漏洞，允许未经授权的攻击者上传精心构造的文件并执行任意代码。 Part1漏洞状态漏洞细节  
| 漏洞POC  
| 漏洞EXP  
| 在野利用  
  
---|---|---|---  
有| 有| 有| 未知  
Part2漏洞描述‍漏洞名称  
|

  GDidees CMS任意文件上传漏洞  
  
---|---  
CVE编号| CVE-2023-27178  
漏洞类型  
|   任意文件上传  
  
漏洞等级| 高危(9.8)  
公开状态| 公开  
漏洞描述|

GDidees CMS 3.9.1及更低版本存在任意文件上传漏洞，允许未经授权的攻击者上传精心构造的文件并执行任意代码。  
  
时间线  
|

2023-4-10 NVD发布  
  
影响产品  
|

GDidees CMS 3.9.1及以下版本  
  
Part3漏洞复现

###  **1\. 复现环境**

系统版本：Kali 2023.1

软件版本：GDidees CMS 3.9.1

 **2\. 复现步骤**

创建文件格式为phar的一句话木马文件

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184358.png)

访问Roxy Fileman插件页面

![]()

上传cmd.phar文件

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184359.png)

携带参数cmd=echo ‘csx lab’;访问cmd.phar页面，可以看到php代码成功执行。

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184400.png)

Part4漏洞分析

###  ****Roxy Fileman插件的index页面没有身份验证功能，因此允许用户直接访问该页面。

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184401.png)

查看Roxy Fileman的conf.json文件，可以发现FORBIDDEN_UPLOADS字段未限制phar格式。

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184402.png)

查看apache2的配置文件，可以发现默认情况下扩展名为php、phar和phtml的文件都被当作php文件解析。因此在当前环境下，上传的phar文件将作为php文件进行解析，从而执行任意代码。

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184403.png)

Part5修复建议

修改conf.json文件中的FORBIDDEN_UPLOADS字段，禁止上传phar格式的文件。

 **![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184405.png)
** **获取更多情报**  

联系我们，获取更多漏洞情报详情及处置建议，让企业远离漏洞威胁。  
电话：18511745601

邮箱：shiliangang@andisec.com **漏洞分析回顾**  
![]()[![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184406.png)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247543027&idx=1&sn=b11441f45f500fd4ebe3a0f59836e446&chksm=fd76c2a4ca014bb26bdc8bc279141502869dac5b3681565cfe887705dfb812dd182d9ba4f92a&scene=21#wechat_redirect)[![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184407.png)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247542786&idx=1&sn=b464a76861667184bd6f352bffa82614&chksm=fd76c255ca014b436e66f1725f27250a44789a9754a58bf851e813f7a51b57da2f238d0c686e&scene=21#wechat_redirect)[![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184408.png)](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247542562&idx=1&sn=8aed9e90dc298f4686d259e3e4d24d13&chksm=fd76cd75ca0144637e38338ca6954b20155238eb7da7478a6068d973496d23f612bbfe44a096&scene=21#wechat_redirect)[![]()](http://mp.weixin.qq.com/s?__biz=MzU3ODQ4NjA3Mg==&mid=2247541957&idx=1&sn=abf6411a10db72df36604e0223bc279e&chksm=fd76ce92ca0147848ad2f0f1555e34b94da43d64acb929e8fc40229d62eb09e71952de77ed6d&scene=21#wechat_redirect)  

北京安帝科技有限公司是新兴的工业网络安全能力供应商，专注于网络化、数字化、智能化背景下的工业网络安全技术、产品、服务的创新研究和实践探索，基于网络空间行为学理论及工业网络系统安全工程方法，围绕工业网络控制系统构建预防、识别、检测、保护、响应、恢复等核心能力优势，为电力、水利、石油石化、轨道交通、烟草、钢铁冶金、智能制造、矿业等关键信息基础设施行业提供安全产品、服务和综合解决方案。坚持IT安全与OT安全融合发展，坚持产品体系的自主可控，全面赋能客户构建“业务应用紧耦合、用户行为强相关、安全风险自适应、网络弹性稳增强”的主动防御和纵深防御相结合的安全保障体系。

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184409.png)

 **点击“ 在看”鼓励一下吧**

**![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230620184411.png)**

预览时标签不可点

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

